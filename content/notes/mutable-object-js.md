---
title: Дескрипторы в объектах JS
tags:
  - javascript
publicationDate: 29 Jun 2023
---

Все объекты в JavaScript передаются с помощью ссылок. При объявлении объекта с помощью `const` интерпретатор будет проверять
не поменялась ли ссылка объекта, которая лежит в значении переменной.

Внутри самого объекта (даже не смотря на `const`) значения могут меняться:

```javascript
const person = {
  name: "Daniil",
  age: 21,
};

person.name = "Alex";

console.log(person); // {name: 'Alex', age: 21}
```

Для того чтобы сделать объеты иммутабельными обычно используют `Object.freeze`, однако это не всегда помогает:

```javascript
const tax = {
  list: [
    'eggs',
    'milk'
  ],
  total: '$24',
  count: {
    eggs: 2,
    milk: 1,
  }
};

const freezedTax = Object.freeze(tax);

freezedTax.total = '$200';
freezedTax.count.eggs = 2400;

console.log(freezedTax); // {list:["eggs","milk"],total:"$24",count:{eggs:2400,milk:1}};
```

Как мы можем увидеть значение `total` не поменялось, а вот вложенные значения в `count` - поменялись.

Мы конечно же можем пройтись с помощью рекурсивной функции по всем полям, тип которых равен объекту и заморозить их с помощью `Object.freeze`,
однако иногда применяют несколько другой подход.

# Дескрипторы
Любые значения в объектах можно задать простым способом (как это было показано вверху) или же с помощью специального
метода `Object.defineProperty`. Упомянутый метод как раз позволяет нам задавать свойства поля: может ли оно изменяться,
можно ли по полю итерироваться и так далее:

```javascript
const tax = {
  list: [
    'eggs',
    'milk'
  ],
  total: '$24',
  count: {
    milk: 1,
  }
};

Object.defineProperty(tax.count, 'eggs', {
  writable: false,
  value: 2
});

tax.count.eggs = 2400;

console.log(tax); // {list:["eggs","milk"],total:"$24",count:{eggs:2,milk:1}};
```

Данное решение подходит для случаев, когда нам нужно сделать неизменяемым одно или несколько свойств.
Несколько свойств делают иммутабельными с помощью `Object.defineProperties`.

Среди конфигурируемых флагов есть следующие:

| Флаг         | Значение                                                                |
|--------------|-------------------------------------------------------------------------|
| writable     | Можно ли перезаписать значение                                          |
| configurable | Можно ли поменять флаги у значения, а также можно ли его переприсвоить  |
| enumerable   | Будет ли ключ значения включен в перечисление ключей с помощью `for in` |